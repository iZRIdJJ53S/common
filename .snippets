# apache
tail -5000 /usr/local/apache2/logs/access_log | awk '{print $1}'  | sort | uniq -c | sort -gr | head -5
tail -5000 /usr/local/apache2/logs/access_log | awk '{print $2}'  | sort | uniq -c | sort -gr | head -5
tail -5000 /usr/local/apache2/logs/access_log | awk '{print $12}' | sort | uniq -c | sort -gr | head -5
tail -5000 /usr/local/apache2/logs/access_log | awk '{print $13}' | sort | uniq -c | sort -gr | head -5

# diff 差分ファイル名だけ表示
diff -q -r ${src} ${dst}

# ファイルのここからここまでを取得したい
sed -n '50,60p' [file_name]


# network search
netstat -tapn | grep ESTABLISHED | more
netstat -tan | grep ":80 " | awk '{print $5}' | awk -F : '{print $4}' | sort | uniq -c | sort -nr | head
lsof -i:80
# 外に出て行くグローバルIPを知りたい時
curl http://checkip.dyndns.com/

# dstat
dstat -tclmdrn
dstat --top-cpu --top-cputime
dstat --top-io --top-bio
dstat --top-cpu --top-cputime --top-io --top-mem

# openssl
openssl x509 -noout -modulus -in *.crt | openssl md5
openssl rsa  -noout -modulus -in *.key | openssl md5
openssl req  -noout -modulus -in *.csr | openssl md5

# ランダムパスワード生成
openssl rand -base64 [n]


# find
# atime … 最終アクセス時刻 (access time)
# mtime … 最終変更時刻 (modify time)
# ctime … 最終ステータス変更時刻 (change time)
find ./ -daystart -ctime +2
find ./ -daystart -ctime -2

# とあるファイルの更新時刻を基準に検索
find ./ -type f -newer /tmp/_file

# 空の新規ファイル作成 or 既存ファイルを空にする
> test.txt

# 無限ループ
while :;do echo '----------'; uptime; sleep 2; done


# date
date +%Y%m%d
date +%s --date "2005-01-01 00:00"
date --date "@1104505200"

# mysql TABLE ENGINE
SELECT table_name,engine FROM information_schema.tables WHERE table_schema = 'niwavide';
# テーブル定義をコピーしてcreate table
CREATE TABLE usermaster_cs LIKE usermaster;
# mysqldump
mysqldump -uroot -p --default-character-set=utf8 --single-transaction --master-data=2 --hex-blob niwavide | gzip > hoge.sql.gz
# mysql user list
select user,host from mysql.user;
# mysql CHANGE MASTER TO
CHANGE MASTER TO MASTER_HOST='', MASTER_USER='', MASTER_PASSWORD='XXXXX', MASTER_LOG_FILE='mysql-bin.XXXXX', MASTER_LOG_POS=XXXXXX;


# xml構文のチェック
xmllint --noout file.xml

# 開いてるファイルでサイズが大きいのはどれ？
lsof / | awk '{ if($7 > 1048576) print $7/1048576 "MB "$9 }' | sort -n -u | tail
